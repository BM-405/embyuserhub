# EmbyUserHub 存储库概述

## 项目简介

EmbyUserHub 是一款专为 Emby 服务器管理员开发的轻量级用户管理系统，集成了卡密激活、自动化管理和用户控制面板等功能，让媒体服务器管理工作变得轻松高效。
## 版本(v3.7.5)小版本更新
### 🔑 **卡密管理**
- ✨ **卡密复制标签**
  - 新增卡密"已复制"状态
  - 卡密列表新增筛选按钮组：全部、未使用、已使用、已复制
### 👤 **用户管理**
- ✨ **筛选按钮**
  - 有效期（七天内过期/30天内过期），用户时间（今天/本周/本月）筛选
### 🔧 **修复与优化**
- 用户续费输入卡密自动识别有效期
- 卡密自动开通Emby账户后，可以直接登录
- 移动端卡密点击筛选自动滚动到"当前卡密列表"区域
- 网页的JavaScript错误修复

## 版本(v3.7.4)的修复更新
### 🐛 **修复**
  - 修复v3.7.3的会话播放器和设备限制设置，对停用用户没有正确的进行停用的错误问题

## 版本(v3.7.3)的主要更新
### 🔄 用户管理
- ✨ **用户导入功能**
  - 新增用户导入（同步Emby用户）功能
  - 支持从Emby服务器同步用户到系统中
  - 导入的用户填写有效期同步选中用户即可导入到系统中
  - 建议不要导入模板用户以及管理员用户
- ✨ **会话管理**
  - 侧边导航栏新增会话管理功能
  - 实时监控当前活跃的播放会话和设备
  - 支持查看用户当前正在播放的媒体内容
  - 实时监控设备状态和播放内容
  - 播放器和设备限制设置
    - 限制播放器类型
    - 设备和流量限制

### 📧 **邮件通知功能**
- ✨ **邮件功能设置**
  - 支持SMTP邮件服务器配置，可使用QQ、163、Gmail等主流邮箱
  - 提供多种邮件通知类型：到期邮件通知、续费邮件通知、激活邮件通知、工单邮件通知
  - 工单创建、回复、状态变更时自动发送邮件
  - 用户界面配置（显示开关）在用户侧边栏显示"邮件设置"
  - 系统管理员可统一控制各类邮件通知的开启与关闭
- ✨ **用户邮件设置**
  - 用户中心侧边导航栏增加邮件设置功能
  - 用户可自定义邮件通知偏好设置
    - 接收续费成功通知
    - 接收到期提醒通知
    - 接收邮件工单提醒

### ⚙️ **系统设置**
- ✨ **商城设置**
  - 商城设置功能，用户菜单栏中是否显示商城入口
- ✨ **媒体中心显示设置**
  - 在用户侧边栏是否显示"媒体中心"

### 🐛 **修复与优化**
- 🔧 **激活码用户创建优化**
  - 优化用户名生成逻辑
  - 完善激活码激活流程的错误处理。
  
- 🔧 **其它优化**
  - 修复用户管理筛选按钮错误的提示
  - 修复卡密管理筛选按钮错误的提示
  - 移除操作日志底部页脚作者/邮箱展示
  - 用户登录页（Emby用户管理中心->用户管理中心）
  - 支持直接ip:29045/<安全码>访问管理员页面
  - 修复创建用户6-12位字母或数字组合密码缺少字母数组的问题

## 版本(v3.6.0)的主要更新
### 🎫 工单管理
- ✨ **工单**
  - 用户可以创建并跟踪问题工单
  - 管理员可以处理和回复用户工单
  - 支持工单状态跟踪和管理员Bark通知功能
- ⚙️ **系统设置**
  - 新增工单系统相关配置选项
  - 支持工单Bark通知设置
  - 支持附件上传功能（附件大小限制/允许附件类型）
  - 在用户侧边栏显示"工单中心" 默认关闭（启用后可见）
- 🔑 **卡密管理功能**
  - 新增批量生成卡密功能
  - 新增批量复制卡密功能
  - 新增7天有效期卡密类型
 
## 版本(v3.5.2)的主要更新
✨ **卡密管理**
- 支持批量生成卡密
- 新增：生成7天卡密

🔧 **用户页面页脚调整**
- 移除作者以及邮箱展示

## 版本(v3.5.0)的主要更新
### 🎨 界面优化与移动端适配
- ✨ **响应式设计增强**
  - 优化管理页面的移动端布局
  - 改进各种屏幕尺寸下的布局和交互体验
- 🌐 **移动端用户体验优化**
  - 针对极小屏幕设备增强界面适配能力
  - 优化移动设备上的按钮大小和间距
  - 改善触控交互体验和视觉反馈
- 🔧 **界面元素布局调整**
  - 统一卡片式设计在不同页面的一致性
  - 优化卡密生成按钮和统计信息展示
  - 增强信息层级结构和视觉引导

## 版本(v3.1.4)的主要更新
- 🔄 ** 用户中心修改密码/用户管理重置密码**
  - 错误的代码造成修改密码/重置密码 密码为空的问题

## 版本(v3.1.3)的主要更新
### 🔄 功能增强与错误修复
- ✨ **管理员续费功能优化**
  - 支持管理员直接为用户续费，无需使用卡密
  - 注意事项：续费操作不可撤回，请谨慎确认续费信息

- 🎨 **用户体验改进**
  - 支持注册时使用自定义有效期(1-365天)
  - 支持注册时使用6-12位字母或数字组合密码
  - 改进已知页面布局问题
- 🐛 **问题修复**
  - 修复用户中心的显示错误
  - 修复用户中心通知栏"新"标志显示异常问题
  - 修复已知的小部分错误
  
## 版本(v3.1.1)的主要更新
### 🧰 媒体中心功能优化
- 🔄 **媒体库页面**
  - 新增媒体库页面，集中展示所有媒体内容 
- ✨ **分页显示功能**
  - 优化最新媒体内容的分页显示机制
  - 每页显示数量，默认20项/页
  - 改进媒体数据获取方式，确保总数统计准确性
## 版本(v3.1.0)的主要更新
### 🎬用户中心仪表盘：
-  **新增功能**
  - 媒体库统计
    - 展示全部媒体总数及各类型(电影/剧集/音乐等)的统计数量
    - 直观呈现媒体库资源分布情况
  - 最近入库
    - 实时展示服务器最新添加的媒体内容
    - 支持各种媒体类型(电影/电视剧/音乐)的显示
    - 媒体海报与详情信息展示效果
    - 多重备用检索方法，确保内容获取可靠性
## 版本(v3.0.9)的主要更新
### 🌐 网络与接口优化
- ✨ **容器网络**
  - 默认使用host网络模式，提升连接性能和稳定性
  - 优化内部网络通信机制，增强与媒体服务器的交互效率

### 🔧 公告功能
- ✨ **管理功能强化**
  - 新增管理员公告管理界面，发布公告
  - 新增用户中心公告栏，展示公告页面

## 项目截图

![管理面板](image/A1.png)

![用户管理](image/A2.png)

![卡密管理](image/A3.png)

![卡密创建](image/A4.png)

![系统设置](image/A6.png)

![用户中心](image/A7.png)

## 核心功能

- **卡密系统**：创建有效期卡密，支持自助激活和续费，卡密创建用户
- **用户管理**：基于模板用户权限复制，支持批量操作和标签备注
- **自动化功能**：自动检查过期用户，定时清理数据，状态同步
- **安全特性**：支持两步验证，安全访问码保护，登录失败限制
- **通知功能**：支持 Bark 推送多种事件通知（到期、续费、激活）
- **用户中心**：用户自助管理中心，支持修改密码、查看卡密、续费等功能
- --**支持卡密创建用户**：支持卡密创建用户，方便管理员管理和维护

## 配置系统

EmbyUserHub提供了灵活的配置系统，配置的加载优先级如下：
1. 环境变量（优先级最高）
2. 配置文件config.py（次优先级）
3. 默认配置（优先级最低）

使用前配置config文件：
- Emby服务器配置
- EMBY_SERVER
- ADMIN_TOKEN
- TEMPLATE_USER_ID

## Docker部署方式

```bash
# 拉取最新镜像
docker pull mmbao/embyuserhub:latest

# 运行容器
docker run -d \
  --name embyuserhub \
  --restart always \
  --network host \
  -v "/opt/embyuserhub/data:/app/data" \
  -v "/opt/embyuserhub/config:/app/config" \
  -e TZ=Asia/Shanghai \
  -e FLASK_SECRET_KEY=C1J-xvthNycHDWODaHZdJMEO--ToI5j6q3G4fKJyThc \
  -e ENABLE_SECURITY_ACCESS=True \
  -e CRON_MODE=thread \
  mmbao/embyuserhub:latest
```
## Flask Secret Key 配置说明

Flask secret key 用于会话安全和其他加密功能，这个密钥应当保密且应该是随机、复杂的字符串。

建议使用以下命令生成安全密钥：
```bash
python3 -c "import secrets; print(secrets.token_urlsafe(32))"
```

然后使用生成的值替换上面 Docker 命令中的 `FLASK_SECRET_KEY` 环境变量。

## 配置文档

详细的配置选项和说明已移至 [CONFIG.md](CONFIG.md) 文件中，包括：

- **基础配置**：服务器端口、访问控制、安全设置
- **Emby 服务器设置**：服务器地址、API密钥、模板用户配置
- **卡密系统配置**：卡密规则、有效期设置、创建用户规则
- **通知系统**：Bark推送设置、事件触发条件
- **自动化任务**：定时任务配置、清理规则
- **安全设置**：两步验证、访问码机制、登录限制参数

所有配置项均可通过环境变量、config.py文件或系统默认值进行设置，请参考配置文档进行个性化调整。

## 开发与贡献

EmbyUserHub 马小兔制作：
- 许可证需支持提供

## 维护与支持

- **作者**：马小兔
- **联系方式**：maxiaotu.mm@gmail.com
- **Docker Hub**：mmbao/embyuserhub

## 支持与捐赠

如果您觉得本项目对您有所帮助，欢迎扫描以下二维码进行捐赠支持，让开发者能够提供更好的服务和功能：

<div align="center">
  <img src="image/捐赠/IMG_4253-0.JPG" alt="捐赠二维码1" width="150"/>
  <img src="image/捐赠/IMG_4316.JPG" alt="捐赠二维码2" width="150"/>
</div>

---

**EmbyUserHub** - 让您的Emby管理更简单、更高效！
